setxkbmap -option caps:swapescape

get_key() {
    if [ "$(setxkbmap -query | grep variant | awk '{print $2'})" = "intl" ]
    then
        key="INTL"
    else
        key="US"
    fi

}

set_batpercent() {
	batpercent="$(acpi | awk '{print $4}' | tr -d ',')" 
}

set_battime() {
battime="$(acpi | awk '{print $5}' | sed 's/:/h/' | sed 's/:/m/' | cut -c -6)"
}

set_batstatus () {
	case $(acpi | awk '{print $3}') in
	Charging,)
		batstatus="CHR"
		;;
	Discharging,)
		batstatus="DRN"
		;;
	Full,)
		batstatus="FULL"
		;;
	*)
		batstatus="?"
		;;
	esac
}

get_key
set_batpercent
set_battime
set_batstatus

while xsetroot -name " $key $(vol) $(date "+%a %b %d %r %Z %Y") $batpercent $battime $batstatus"
do
    get_key
    set_batpercent
    set_battime
    set_batstatus
	sleep 1
done &

exec dwm
